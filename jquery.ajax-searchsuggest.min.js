!function(a){function b(b){function c(a){var b=a.position(),c=a.outerHeight(),d=b.top+c+1*a.css("margin-top").replace("px","")+"px",e=b.left+1*a.css("margin-left").replace("px","")+"px";a.parents("form").next().css({position:"absolute",top:d,left:e})}var d,e,f=!1,g=b.parents();g.each(function(){return"none"==a(this).css("display")?(f=!0,d=a(this),e=d.attr("style"),!1):void 0}),g.each(function(){return"FORM"===a(this).get(0).tagName?(a(this).parent().css("static"===a(this).parent().css("position")?{position:"relative","z-index":"10"}:{"z-index":"10"}),!1):void 0}),f===!1?c(b):(d.show(),c(b),void 0===e?d.removeAttr("style"):d.attr("style",e))}function c(){return/iphone|ip[ao]d|android/i.test(navigator.userAgent)}a.fn.ajaxSearchSuggest=function(){return a(this).each(function(){if(-1!==a.inArray(a(this).attr("type"),["text","search","url"])){var d="";d="ja"===(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2)?"Tab &darr;&uarr; キーで選択":"Select by Tab or &darr;&uarr; key";var e='<div class="ajaxSearchSuggestWrapper"><ul class="ajaxSearchSuggest"></ul>';e+=c()?"</div>":'<div class="selectionKey">'+d+"</div></div>",a(this).parents("form").after(e);var f=a(this),g=a(this).parents("form").next(".ajaxSearchSuggestWrapper"),h=g.children(".ajaxSearchSuggest");b(f),a(window).resize(function(){b(f)}),f.keydown(function(b){return 9===b.which?!1:void(13===b.which?a("li",h).hasClass("selected")&&f.val(a(".selected",h).text()):27===b.which&&(g.hide(),h.html("")))}),f.keyup(function(b){var c=[9,40,38,27,16,17,18];if(-1===a.inArray(b.which,c));else if(-1!==a.inArray(b.which,[9,40,38])){var d=a("li",h).index(a(".selected",h));if(-1===d)9===b.which&&b.shiftKey===!1||40===b.which?a("li:first-child",h).addClass("selected"):(38===b.which||9===b.which&&b.shiftKey===!0)&&a("li:last-child",h).addClass("selected");else{var e=a("li",h).eq(d);9===b.which&&b.shiftKey===!1||40===b.which?(e.removeClass("selected"),e.is(":last-child")?a("li:first-child",h).addClass("selected"):e.next().addClass("selected")):(9===b.which&&b.shiftKey===!0||38===b.which)&&(e.removeClass("selected"),e.is(":first-child")?a("li:last-child",h).addClass("selected"):e.prev().addClass("selected"))}}else 27===b.which&&(g.hide(),h.html(""))}),f.focus(function(){var b,c,d=a(this),e=0;setInterval(function(){b=d.val(),c=b.length,0===c&&(g.hide(),h.html("")),c!==e&&(e=c,a.ajax({url:"https://www.google.com/complete/search",dataType:"jsonp",data:{q:b,client:"hp",nolabels:"t"},success:function(b){var c=b[1].length;if(0===c)return g.hide(),void h.html("");for(var d="",e=0;c>e;e++)d+='<li class="ajaxSearchSuggestListItem">'+b[1][e][0]+"</li>";h.html(d),g.show().css("min-width",f.outerWidth()),a("li",h).click(function(){f.val(a(this).text()),g.hide(),h.html(""),f.parent("form").submit()}),a("body").not(g).click(function(){g.hide(),h.html("")});var i=[];a("li",h).mousemove(function(){a("li",h).removeClass("selected"),a(this).hasClass("selected")||(a(this).addClass("selected"),i.push(a("li",h).index(a(this))),i.length>2&&i.shift(),i[0]!=i[1]&&a("li",h).eq(i[0]).removeClass("selected"))})}}))},100)})}}),this}}(jQuery);